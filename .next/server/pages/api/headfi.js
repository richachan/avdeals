"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/headfi";
exports.ids = ["pages/api/headfi"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "puppeteer":
/*!****************************!*\
  !*** external "puppeteer" ***!
  \****************************/
/***/ ((module) => {

module.exports = import("puppeteer");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fheadfi&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cheadfi.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fheadfi&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cheadfi.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\headfi.ts */ \"(api)/./src/pages/api/headfi.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/headfi\",\n        pathname: \"/api/headfi\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmhlYWRmaSZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyU1Q3BhZ2VzJTVDYXBpJTVDaGVhZGZpLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNFO0FBQzFEO0FBQ3lEO0FBQ3pEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxxREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMscURBQVE7QUFDcEM7QUFDTyx3QkFBd0IseUdBQW1CO0FBQ2xEO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmNcXFxccGFnZXNcXFxcYXBpXFxcXGhlYWRmaS50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCAnZGVmYXVsdCcpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgJ2NvbmZpZycpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvaGVhZGZpXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvaGVhZGZpXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogJycsXG4gICAgICAgIGZpbGVuYW1lOiAnJ1xuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fheadfi&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cheadfi.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/headfi.ts":
/*!*********************************!*\
  !*** ./src/pages/api/headfi.ts ***!
  \*********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var puppeteer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! puppeteer */ \"puppeteer\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([puppeteer__WEBPACK_IMPORTED_MODULE_0__]);\npuppeteer__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n//Cache to store and return the same results for the same query\nconst cache = new Map;\n//clear cache every hour\nsetInterval(()=>{\n    console.log('Clearing the cache...');\n    cache.clear();\n}, 3600000);\n//Handler that scrapes HeadFi listings with multitab processing\nasync function handler(req, res) {\n    const { query } = req.query;\n    //Ensure the query is valid\n    if (typeof query !== 'string' || query.trim() === '') {\n        return res.status(400).json({\n            error: 'Invalid query'\n        });\n    }\n    if (cache.has(query)) {\n        console.log(`Query match in cache!: ${query}`);\n        return res.status(200).json(cache.get(query)); // Return cached result\n    }\n    const searchUrl = `https://www.head-fi.org/search/39110786/?q=${encodeURIComponent(query)}&t=hfc_listing&c[categories][0]=1&c[child_categories]=1&o=date`;\n    const browser = await puppeteer__WEBPACK_IMPORTED_MODULE_0__[\"default\"].launch({\n        headless: true\n    });\n    const page = await browser.newPage();\n    try {\n        await page.goto(searchUrl, {\n            waitUntil: 'domcontentloaded'\n        });\n        // Check for no listings\n        const elementExists = await page.$$('.block-row');\n        if (elementExists.length === 0) {\n            console.log('No elements found with the selector \".block-row\". (HeadFi)');\n            await browser.close();\n            return res.status(200).json([]);\n        }\n        await page.waitForSelector('.block-row'); //Ensure the listings are loaded\n        //Grab all listing links and prices on the search results page\n        const listingsFromSearch = await page.evaluate(()=>{\n            const listings = [];\n            const items = document.querySelectorAll('.block-row');\n            items.forEach((item)=>{\n                const titleElement = item.querySelector('.contentRow-title a');\n                const priceElement = item.querySelector('.contentRow-extra dd');\n                const flairElement = item.querySelector('span.label.label--primary');\n                const title = titleElement ? titleElement.textContent?.trim() : '';\n                const link = titleElement ? `https://www.head-fi.org${titleElement.getAttribute('href')}` : '';\n                const price = priceElement ? priceElement.textContent?.trim() : null;\n                const flair = flairElement ? flairElement.textContent?.trim() : null;\n                const site = 'headfi';\n                if (title && link && !flair?.toUpperCase().includes('TRADE') && !flair?.toUpperCase().includes('WANT TO BUY')) {\n                    listings.push({\n                        title,\n                        link,\n                        price,\n                        site\n                    });\n                }\n            });\n            return listings;\n        });\n        //opens each listing page and checks if the listing is still available as that information is not available on the search results page\n        const processListing = async (listing)=>{\n            try {\n                const { link, title, price, site } = listing;\n                //Open the listing page and check if the title includes \"SOLD\" and other keywords\n                const listingPage = await browser.newPage();\n                await listingPage.goto(link, {\n                    waitUntil: 'domcontentloaded'\n                });\n                const listingTitle = await listingPage.evaluate(()=>{\n                    const titleElement = document.querySelector('.p-title-value');\n                    return titleElement ? titleElement.textContent?.trim() : null;\n                });\n                await listingPage.close();\n                if (listingTitle) {\n                    const title = listingTitle.toUpperCase(); //normalize titles for comparison\n                    if (!title.includes('SOLD') && !title.includes('PURCHASED') && !title.includes('CLOSED') && !title.includes('TRADED') && title.includes(query.toUpperCase()) && !price.startsWith('0.00') //WTB or WTT listings have a price of 0.00 and can easily be filtered out with this check\n                    ) {\n                        return {\n                            title,\n                            link,\n                            price,\n                            site\n                        };\n                    }\n                }\n                return null; //Return null for invalid listings\n            } catch (error) {\n                console.error(`Error processing listing ${listing.link}:`, error);\n                return null;\n            }\n        };\n        //Process all listings concurrently with a limited number of tabs\n        const maxConcurrency = 10; // Number of concurrent tabs Next Step: rotating proxies or plugin to avoid detection\n        const results = [];\n        for(let i = 0; i < listingsFromSearch.length; i += maxConcurrency){\n            const chunk = listingsFromSearch.slice(i, i + maxConcurrency);\n            const chunkResults = await Promise.all(chunk.map((listing)=>processListing(listing)));\n            results.push(...chunkResults.filter(Boolean)); // Filter out null results\n        }\n        await browser.close();\n        //Cache the results for the query\n        cache.set(query, results);\n        res.status(200).json(results);\n    } catch (error) {\n        console.error('Scraping error:', error);\n        await browser.close();\n        res.status(500).json({\n            error: 'Failed to retrieve listings'\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUMsR0FBRyxDQUFDSixNQUFNSyxHQUFHLENBQUNaLENBQUFBLFVBQVdELGVBQWVDO1lBQzNFSyxRQUFRUCxJQUFJLElBQUlXLGFBQWFJLE1BQU0sQ0FBQ0MsV0FBVywwQkFBMEI7UUFDN0U7UUFDQSxNQUFNakQsUUFBUVUsS0FBSztRQUVuQixpQ0FBaUM7UUFDakM1QixNQUFNb0UsR0FBRyxDQUFDM0QsT0FBT2lEO1FBRWpCbEQsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQzhDO0lBQ3pCLEVBQUUsT0FBTzdDLE9BQU87UUFDWlYsUUFBUVUsS0FBSyxDQUFDLG1CQUFtQkE7UUFDakMsTUFBTUssUUFBUVUsS0FBSztRQUNuQnBCLElBQUlHLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUE4QjtJQUNoRTtBQUVKIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGp0Yy1zdGFmZlxcRGVza3RvcFxcYXZkZWFsc1xcc3JjXFxwYWdlc1xcYXBpXFxoZWFkZmkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xyXG5pbXBvcnQgcHVwcGV0ZWVyIGZyb20gJ3B1cHBldGVlcic7XHJcblxyXG4vL0NhY2hlIHRvIHN0b3JlIGFuZCByZXR1cm4gdGhlIHNhbWUgcmVzdWx0cyBmb3IgdGhlIHNhbWUgcXVlcnlcclxuY29uc3QgY2FjaGUgPSBuZXcgTWFwO1xyXG5cclxuLy9jbGVhciBjYWNoZSBldmVyeSBob3VyXHJcbnNldEludGVydmFsKCgpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKCdDbGVhcmluZyB0aGUgY2FjaGUuLi4nKTtcclxuICAgIGNhY2hlLmNsZWFyKCk7XHJcbn0sIDM2MDAwMDApO1xyXG5cclxuLy9IYW5kbGVyIHRoYXQgc2NyYXBlcyBIZWFkRmkgbGlzdGluZ3Mgd2l0aCBtdWx0aXRhYiBwcm9jZXNzaW5nXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIFxyXG57XHJcbiAgICBjb25zdCB7IHF1ZXJ5IH0gPSByZXEucXVlcnk7XHJcblxyXG4gICAgLy9FbnN1cmUgdGhlIHF1ZXJ5IGlzIHZhbGlkXHJcbiAgICBpZiAodHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJyB8fCBxdWVyeS50cmltKCkgPT09ICcnKSBcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgcXVlcnknIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjYWNoZS5oYXMocXVlcnkpKSBcclxuICAgIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgUXVlcnkgbWF0Y2ggaW4gY2FjaGUhOiAke3F1ZXJ5fWApO1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihjYWNoZS5nZXQocXVlcnkpKTsgLy8gUmV0dXJuIGNhY2hlZCByZXN1bHRcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzZWFyY2hVcmwgPSBgaHR0cHM6Ly93d3cuaGVhZC1maS5vcmcvc2VhcmNoLzM5MTEwNzg2Lz9xPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KX0mdD1oZmNfbGlzdGluZyZjW2NhdGVnb3JpZXNdWzBdPTEmY1tjaGlsZF9jYXRlZ29yaWVzXT0xJm89ZGF0ZWA7XHJcbiAgICBjb25zdCBicm93c2VyID0gYXdhaXQgcHVwcGV0ZWVyLmxhdW5jaCh7IGhlYWRsZXNzOiB0cnVlIH0pO1xyXG4gICAgY29uc3QgcGFnZSA9IGF3YWl0IGJyb3dzZXIubmV3UGFnZSgpO1xyXG5cclxuICAgIHRyeSBcclxuICAgIHtcclxuICAgICAgICBhd2FpdCBwYWdlLmdvdG8oc2VhcmNoVXJsLCB7IHdhaXRVbnRpbDogJ2RvbWNvbnRlbnRsb2FkZWQnIH0pO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBmb3Igbm8gbGlzdGluZ3NcclxuICAgICAgICBjb25zdCBlbGVtZW50RXhpc3RzID0gYXdhaXQgcGFnZS4kJCgnLmJsb2NrLXJvdycpOyBcclxuICAgICAgICBpZiAoZWxlbWVudEV4aXN0cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIGVsZW1lbnRzIGZvdW5kIHdpdGggdGhlIHNlbGVjdG9yIFwiLmJsb2NrLXJvd1wiLiAoSGVhZEZpKScpO1xyXG4gICAgICAgICAgICBhd2FpdCBicm93c2VyLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihbXSk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYXdhaXQgcGFnZS53YWl0Rm9yU2VsZWN0b3IoJy5ibG9jay1yb3cnKTsgLy9FbnN1cmUgdGhlIGxpc3RpbmdzIGFyZSBsb2FkZWRcclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIC8vR3JhYiBhbGwgbGlzdGluZyBsaW5rcyBhbmQgcHJpY2VzIG9uIHRoZSBzZWFyY2ggcmVzdWx0cyBwYWdlXHJcbiAgICAgICAgY29uc3QgbGlzdGluZ3NGcm9tU2VhcmNoID0gYXdhaXQgcGFnZS5ldmFsdWF0ZSgoKSA9PlxyXG4gICAgICAgICAgICAge1xyXG4gICAgICAgICAgICBjb25zdCBsaXN0aW5ncyA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ibG9jay1yb3cnKTtcclxuXHJcbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0aXRsZUVsZW1lbnQgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50Um93LXRpdGxlIGEnKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByaWNlRWxlbWVudCA9IGl0ZW0ucXVlcnlTZWxlY3RvcignLmNvbnRlbnRSb3ctZXh0cmEgZGQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBmbGFpckVsZW1lbnQgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4ubGFiZWwubGFiZWwtLXByaW1hcnknKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0aXRsZSA9IHRpdGxlRWxlbWVudCA/IHRpdGxlRWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpIDogJyc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gdGl0bGVFbGVtZW50ID8gYGh0dHBzOi8vd3d3LmhlYWQtZmkub3JnJHt0aXRsZUVsZW1lbnQuZ2V0QXR0cmlidXRlKCdocmVmJyl9YCA6ICcnO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJpY2UgPSBwcmljZUVsZW1lbnQgPyBwcmljZUVsZW1lbnQudGV4dENvbnRlbnQ/LnRyaW0oKSA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmbGFpciA9IGZsYWlyRWxlbWVudCA/IGZsYWlyRWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpIDogbnVsbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNpdGUgPSAnaGVhZGZpJztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGl0bGUgJiYgbGluayAgJiYgIWZsYWlyPy50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCdUUkFERScpICYmICFmbGFpcj8udG9VcHBlckNhc2UoKS5pbmNsdWRlcygnV0FOVCBUTyBCVVknKSkgXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdGluZ3MucHVzaCh7IHRpdGxlLCBsaW5rLCBwcmljZSwgc2l0ZSB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbGlzdGluZ3M7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vb3BlbnMgZWFjaCBsaXN0aW5nIHBhZ2UgYW5kIGNoZWNrcyBpZiB0aGUgbGlzdGluZyBpcyBzdGlsbCBhdmFpbGFibGUgYXMgdGhhdCBpbmZvcm1hdGlvbiBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSBzZWFyY2ggcmVzdWx0cyBwYWdlXHJcbiAgICAgICAgY29uc3QgcHJvY2Vzc0xpc3RpbmcgPSBhc3luYyAobGlzdGluZzogeyB0aXRsZTogc3RyaW5nOyBsaW5rOiBzdHJpbmc7IHByaWNlOiBzdHJpbmc7IHNpdGU6IHN0cmluZ30pID0+IHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgbGluaywgdGl0bGUsIHByaWNlLCBzaXRlfSA9IGxpc3Rpbmc7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9PcGVuIHRoZSBsaXN0aW5nIHBhZ2UgYW5kIGNoZWNrIGlmIHRoZSB0aXRsZSBpbmNsdWRlcyBcIlNPTERcIiBhbmQgb3RoZXIga2V5d29yZHNcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxpc3RpbmdQYWdlID0gYXdhaXQgYnJvd3Nlci5uZXdQYWdlKCk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBsaXN0aW5nUGFnZS5nb3RvKGxpbmssIHsgd2FpdFVudGlsOiAnZG9tY29udGVudGxvYWRlZCcgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgbGlzdGluZ1RpdGxlID0gYXdhaXQgbGlzdGluZ1BhZ2UuZXZhbHVhdGUoKCkgPT4gXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGl0bGVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnAtdGl0bGUtdmFsdWUnKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGl0bGVFbGVtZW50ID8gdGl0bGVFbGVtZW50LnRleHRDb250ZW50Py50cmltKCkgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgbGlzdGluZ1BhZ2UuY2xvc2UoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobGlzdGluZ1RpdGxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBsaXN0aW5nVGl0bGUudG9VcHBlckNhc2UoKTsgLy9ub3JtYWxpemUgdGl0bGVzIGZvciBjb21wYXJpc29uXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAhdGl0bGUuaW5jbHVkZXMoJ1NPTEQnKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAhdGl0bGUuaW5jbHVkZXMoJ1BVUkNIQVNFRCcpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICF0aXRsZS5pbmNsdWRlcygnQ0xPU0VEJykgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgIXRpdGxlLmluY2x1ZGVzKCdUUkFERUQnKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZS5pbmNsdWRlcyhxdWVyeS50b1VwcGVyQ2FzZSgpKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAhcHJpY2Uuc3RhcnRzV2l0aCgnMC4wMCcpIC8vV1RCIG9yIFdUVCBsaXN0aW5ncyBoYXZlIGEgcHJpY2Ugb2YgMC4wMCBhbmQgY2FuIGVhc2lseSBiZSBmaWx0ZXJlZCBvdXQgd2l0aCB0aGlzIGNoZWNrXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHRpdGxlLCBsaW5rLCBwcmljZSwgc2l0ZX07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vUmV0dXJuIG51bGwgZm9yIGludmFsaWQgbGlzdGluZ3NcclxuXHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBwcm9jZXNzaW5nIGxpc3RpbmcgJHtsaXN0aW5nLmxpbmt9OmAsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy9Qcm9jZXNzIGFsbCBsaXN0aW5ncyBjb25jdXJyZW50bHkgd2l0aCBhIGxpbWl0ZWQgbnVtYmVyIG9mIHRhYnNcclxuICAgICAgICBjb25zdCBtYXhDb25jdXJyZW5jeSA9IDEwOyAvLyBOdW1iZXIgb2YgY29uY3VycmVudCB0YWJzIE5leHQgU3RlcDogcm90YXRpbmcgcHJveGllcyBvciBwbHVnaW4gdG8gYXZvaWQgZGV0ZWN0aW9uXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IFtdOyBcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RpbmdzRnJvbVNlYXJjaC5sZW5ndGg7IGkgKz0gbWF4Q29uY3VycmVuY3kpIHtcclxuICAgICAgICAgICAgY29uc3QgY2h1bmsgPSBsaXN0aW5nc0Zyb21TZWFyY2guc2xpY2UoaSwgaSArIG1heENvbmN1cnJlbmN5KTtcclxuICAgICAgICAgICAgY29uc3QgY2h1bmtSZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwoY2h1bmsubWFwKGxpc3RpbmcgPT4gcHJvY2Vzc0xpc3RpbmcobGlzdGluZykpKTtcclxuICAgICAgICAgICAgcmVzdWx0cy5wdXNoKC4uLmNodW5rUmVzdWx0cy5maWx0ZXIoQm9vbGVhbikpOyAvLyBGaWx0ZXIgb3V0IG51bGwgcmVzdWx0c1xyXG4gICAgICAgIH1cclxuICAgICAgICBhd2FpdCBicm93c2VyLmNsb3NlKCk7IFxyXG5cclxuICAgICAgICAvL0NhY2hlIHRoZSByZXN1bHRzIGZvciB0aGUgcXVlcnlcclxuICAgICAgICBjYWNoZS5zZXQocXVlcnksIHJlc3VsdHMpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdHMpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdTY3JhcGluZyBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgYXdhaXQgYnJvd3Nlci5jbG9zZSgpO1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gcmV0cmlldmUgbGlzdGluZ3MnIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbn1cclxuIl0sIm5hbWVzIjpbInB1cHBldGVlciIsImNhY2hlIiwiTWFwIiwic2V0SW50ZXJ2YWwiLCJjb25zb2xlIiwibG9nIiwiY2xlYXIiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwicXVlcnkiLCJ0cmltIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiaGFzIiwiZ2V0Iiwic2VhcmNoVXJsIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiYnJvd3NlciIsImxhdW5jaCIsImhlYWRsZXNzIiwicGFnZSIsIm5ld1BhZ2UiLCJnb3RvIiwid2FpdFVudGlsIiwiZWxlbWVudEV4aXN0cyIsIiQkIiwibGVuZ3RoIiwiY2xvc2UiLCJ3YWl0Rm9yU2VsZWN0b3IiLCJsaXN0aW5nc0Zyb21TZWFyY2giLCJldmFsdWF0ZSIsImxpc3RpbmdzIiwiaXRlbXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaXRlbSIsInRpdGxlRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwcmljZUVsZW1lbnQiLCJmbGFpckVsZW1lbnQiLCJ0aXRsZSIsInRleHRDb250ZW50IiwibGluayIsImdldEF0dHJpYnV0ZSIsInByaWNlIiwiZmxhaXIiLCJzaXRlIiwidG9VcHBlckNhc2UiLCJpbmNsdWRlcyIsInB1c2giLCJwcm9jZXNzTGlzdGluZyIsImxpc3RpbmciLCJsaXN0aW5nUGFnZSIsImxpc3RpbmdUaXRsZSIsInN0YXJ0c1dpdGgiLCJtYXhDb25jdXJyZW5jeSIsInJlc3VsdHMiLCJpIiwiY2h1bmsiLCJzbGljZSIsImNodW5rUmVzdWx0cyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJmaWx0ZXIiLCJCb29sZWFuIiwic2V0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/headfi.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fheadfi&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cheadfi.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();