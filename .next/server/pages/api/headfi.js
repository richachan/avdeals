"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/headfi";
exports.ids = ["pages/api/headfi"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "puppeteer":
/*!****************************!*\
  !*** external "puppeteer" ***!
  \****************************/
/***/ ((module) => {

module.exports = import("puppeteer");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fheadfi&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fheadfi.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fheadfi&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fheadfi.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/headfi.ts */ \"(api)/./src/pages/api/headfi.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/headfi\",\n        pathname: \"/api/headfi\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_headfi_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmhlYWRmaSZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyUyRnBhZ2VzJTJGYXBpJTJGaGVhZGZpLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNFO0FBQzFEO0FBQ3NEO0FBQ3REO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxxREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMscURBQVE7QUFDcEM7QUFDTyx3QkFBd0IseUdBQW1CO0FBQ2xEO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmMvcGFnZXMvYXBpL2hlYWRmaS50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCAnZGVmYXVsdCcpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgJ2NvbmZpZycpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvaGVhZGZpXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvaGVhZGZpXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogJycsXG4gICAgICAgIGZpbGVuYW1lOiAnJ1xuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fheadfi&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fheadfi.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/headfi.ts":
/*!*********************************!*\
  !*** ./src/pages/api/headfi.ts ***!
  \*********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var puppeteer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! puppeteer */ \"puppeteer\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([puppeteer__WEBPACK_IMPORTED_MODULE_0__]);\npuppeteer__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n//Cache to store and return the same results for the same query\nconst cache = new Map;\n//clear cache every hour\nsetInterval(()=>{\n    console.log('Clearing the cache...');\n    cache.clear();\n}, 3600000);\n//Handler that scrapes HeadFi listings with multitab processing\nasync function handler(req, res) {\n    const { query } = req.query;\n    //Ensure the query is valid\n    if (typeof query !== 'string' || query.trim() === '') {\n        return res.status(400).json({\n            error: 'Invalid query'\n        });\n    }\n    if (cache.has(query)) {\n        console.log(`Query match in cache!: ${query}`);\n        return res.status(200).json(cache.get(query)); // Return cached result\n    }\n    const searchUrl = `https://www.head-fi.org/search/39110786/?q=${encodeURIComponent(query)}&t=hfc_listing&c[categories][0]=1&c[child_categories]=1&o=date`;\n    const browser = await puppeteer__WEBPACK_IMPORTED_MODULE_0__[\"default\"].launch({\n        headless: true\n    });\n    const page = await browser.newPage();\n    try {\n        await page.goto(searchUrl, {\n            waitUntil: 'domcontentloaded'\n        });\n        await page.waitForSelector('.block-row'); //Ensure the listings are loaded\n        //Grab all listing links and prices on the search results page\n        const listingsFromSearch = await page.evaluate(()=>{\n            const listings = [];\n            const items = document.querySelectorAll('.block-row');\n            items.forEach((item)=>{\n                const titleElement = item.querySelector('.contentRow-title a');\n                const priceElement = item.querySelector('.contentRow-extra dd');\n                const flairElement = item.querySelector('span.label.label--primary');\n                const title = titleElement ? titleElement.textContent?.trim() : '';\n                const link = titleElement ? `https://www.head-fi.org${titleElement.getAttribute('href')}` : '';\n                const price = priceElement ? priceElement.textContent?.trim() : null;\n                const flair = flairElement ? flairElement.textContent?.trim() : null;\n                const site = 'headfi';\n                if (title && link && !flair?.toUpperCase().includes('TRADE') && !flair?.toUpperCase().includes('WANT TO BUY')) {\n                    listings.push({\n                        title,\n                        link,\n                        price,\n                        site\n                    });\n                }\n            });\n            return listings;\n        });\n        //opens each listing page and checks if the listing is still available as that information is not available on the search results page\n        const processListing = async (listing)=>{\n            try {\n                const { link, title, price, site } = listing;\n                //Open the listing page and check if the title includes \"SOLD\" and other keywords\n                const listingPage = await browser.newPage();\n                await listingPage.goto(link, {\n                    waitUntil: 'domcontentloaded'\n                });\n                const listingTitle = await listingPage.evaluate(()=>{\n                    const titleElement = document.querySelector('.p-title-value');\n                    return titleElement ? titleElement.textContent?.trim() : null;\n                });\n                await listingPage.close();\n                if (listingTitle) {\n                    const title = listingTitle.toUpperCase(); //normalize titles for comparison\n                    if (!title.includes('SOLD') && !title.includes('PURCHASED') && !title.includes('CLOSED') && !title.includes('TRADED') && title.includes(query.toUpperCase()) && !price.startsWith('0.00') //WTB or WTT listings have a price of 0.00 and can easily be filtered out with this check\n                    ) {\n                        return {\n                            title,\n                            link,\n                            price,\n                            site\n                        };\n                    }\n                }\n                return null; //Return null for invalid listings\n            } catch (error) {\n                console.error(`Error processing listing ${listing.link}:`, error);\n                return null;\n            }\n        };\n        //Process all listings concurrently with a limited number of tabs\n        const maxConcurrency = 10; // Number of concurrent tabs Next Step: rotating proxies or plugin to avoid detection\n        const results = [];\n        for(let i = 0; i < listingsFromSearch.length; i += maxConcurrency){\n            const chunk = listingsFromSearch.slice(i, i + maxConcurrency);\n            const chunkResults = await Promise.all(chunk.map((listing)=>processListing(listing)));\n            results.push(...chunkResults.filter(Boolean)); // Filter out null results\n        }\n        await browser.close();\n        //Cache the results for the query\n        cache.set(query, results);\n        res.status(200).json(results);\n    } catch (error) {\n        console.error('Scraping error:', error);\n        await browser.close();\n        res.status(500).json({\n            error: 'Failed to retrieve listings'\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQzJDO0lBQ3pCLEVBQUUsT0FBTzFDLE9BQU87UUFDWlYsUUFBUVUsS0FBSyxDQUFDLG1CQUFtQkE7UUFDakMsTUFBTUssUUFBUWtDLEtBQUs7UUFDbkI1QyxJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBOEI7SUFDaEU7QUFFSiIsInNvdXJjZXMiOlsiL1VzZXJzL3JpY2h5Y2hhbi93b29wL3NyYy9wYWdlcy9hcGkvaGVhZGZpLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCBwdXBwZXRlZXIgZnJvbSAncHVwcGV0ZWVyJztcblxuLy9DYWNoZSB0byBzdG9yZSBhbmQgcmV0dXJuIHRoZSBzYW1lIHJlc3VsdHMgZm9yIHRoZSBzYW1lIHF1ZXJ5XG5jb25zdCBjYWNoZSA9IG5ldyBNYXA7XG5cbi8vY2xlYXIgY2FjaGUgZXZlcnkgaG91clxuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdDbGVhcmluZyB0aGUgY2FjaGUuLi4nKTtcbiAgICBjYWNoZS5jbGVhcigpO1xufSwgMzYwMDAwMCk7XG5cbi8vSGFuZGxlciB0aGF0IHNjcmFwZXMgSGVhZEZpIGxpc3RpbmdzIHdpdGggbXVsdGl0YWIgcHJvY2Vzc2luZ1xuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkgXG57XG4gICAgY29uc3QgeyBxdWVyeSB9ID0gcmVxLnF1ZXJ5O1xuXG4gICAgLy9FbnN1cmUgdGhlIHF1ZXJ5IGlzIHZhbGlkXG4gICAgaWYgKHR5cGVvZiBxdWVyeSAhPT0gJ3N0cmluZycgfHwgcXVlcnkudHJpbSgpID09PSAnJykgXG4gICAge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgcXVlcnknIH0pO1xuICAgIH1cblxuICAgIGlmIChjYWNoZS5oYXMocXVlcnkpKSBcbiAgICB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBRdWVyeSBtYXRjaCBpbiBjYWNoZSE6ICR7cXVlcnl9YCk7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihjYWNoZS5nZXQocXVlcnkpKTsgLy8gUmV0dXJuIGNhY2hlZCByZXN1bHRcbiAgICB9XG5cbiAgICBjb25zdCBzZWFyY2hVcmwgPSBgaHR0cHM6Ly93d3cuaGVhZC1maS5vcmcvc2VhcmNoLzM5MTEwNzg2Lz9xPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KX0mdD1oZmNfbGlzdGluZyZjW2NhdGVnb3JpZXNdWzBdPTEmY1tjaGlsZF9jYXRlZ29yaWVzXT0xJm89ZGF0ZWA7XG4gICAgY29uc3QgYnJvd3NlciA9IGF3YWl0IHB1cHBldGVlci5sYXVuY2goeyBoZWFkbGVzczogdHJ1ZSB9KTtcbiAgICBjb25zdCBwYWdlID0gYXdhaXQgYnJvd3Nlci5uZXdQYWdlKCk7XG5cbiAgICB0cnkgXG4gICAge1xuICAgICAgICBhd2FpdCBwYWdlLmdvdG8oc2VhcmNoVXJsLCB7IHdhaXRVbnRpbDogJ2RvbWNvbnRlbnRsb2FkZWQnIH0pO1xuICAgICAgICBhd2FpdCBwYWdlLndhaXRGb3JTZWxlY3RvcignLmJsb2NrLXJvdycpOyAvL0Vuc3VyZSB0aGUgbGlzdGluZ3MgYXJlIGxvYWRlZFxuXG4gICAgICAgIC8vR3JhYiBhbGwgbGlzdGluZyBsaW5rcyBhbmQgcHJpY2VzIG9uIHRoZSBzZWFyY2ggcmVzdWx0cyBwYWdlXG4gICAgICAgIGNvbnN0IGxpc3RpbmdzRnJvbVNlYXJjaCA9IGF3YWl0IHBhZ2UuZXZhbHVhdGUoKCkgPT5cbiAgICAgICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBsaXN0aW5ncyA9IFtdO1xuICAgICAgICAgICAgY29uc3QgaXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYmxvY2stcm93Jyk7XG5cbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGl0bGVFbGVtZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKCcuY29udGVudFJvdy10aXRsZSBhJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJpY2VFbGVtZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKCcuY29udGVudFJvdy1leHRyYSBkZCcpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZmxhaXJFbGVtZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKCdzcGFuLmxhYmVsLmxhYmVsLS1wcmltYXJ5Jyk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0aXRsZSA9IHRpdGxlRWxlbWVudCA/IHRpdGxlRWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpIDogJyc7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluayA9IHRpdGxlRWxlbWVudCA/IGBodHRwczovL3d3dy5oZWFkLWZpLm9yZyR7dGl0bGVFbGVtZW50LmdldEF0dHJpYnV0ZSgnaHJlZicpfWAgOiAnJztcbiAgICAgICAgICAgICAgICBjb25zdCBwcmljZSA9IHByaWNlRWxlbWVudCA/IHByaWNlRWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpIDogbnVsbDtcbiAgICAgICAgICAgICAgICBjb25zdCBmbGFpciA9IGZsYWlyRWxlbWVudCA/IGZsYWlyRWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpIDogbnVsbDtcbiAgICAgICAgICAgICAgICBjb25zdCBzaXRlID0gJ2hlYWRmaSc7XG5cbiAgICAgICAgICAgICAgICBpZiAodGl0bGUgJiYgbGluayAgJiYgIWZsYWlyPy50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCdUUkFERScpICYmICFmbGFpcj8udG9VcHBlckNhc2UoKS5pbmNsdWRlcygnV0FOVCBUTyBCVVknKSkgXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBsaXN0aW5ncy5wdXNoKHsgdGl0bGUsIGxpbmssIHByaWNlLCBzaXRlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gbGlzdGluZ3M7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vb3BlbnMgZWFjaCBsaXN0aW5nIHBhZ2UgYW5kIGNoZWNrcyBpZiB0aGUgbGlzdGluZyBpcyBzdGlsbCBhdmFpbGFibGUgYXMgdGhhdCBpbmZvcm1hdGlvbiBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSBzZWFyY2ggcmVzdWx0cyBwYWdlXG4gICAgICAgIGNvbnN0IHByb2Nlc3NMaXN0aW5nID0gYXN5bmMgKGxpc3Rpbmc6IHsgdGl0bGU6IHN0cmluZzsgbGluazogc3RyaW5nOyBwcmljZTogc3RyaW5nOyBzaXRlOiBzdHJpbmd9KSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgbGluaywgdGl0bGUsIHByaWNlLCBzaXRlfSA9IGxpc3Rpbmc7XG5cbiAgICAgICAgICAgICAgICAvL09wZW4gdGhlIGxpc3RpbmcgcGFnZSBhbmQgY2hlY2sgaWYgdGhlIHRpdGxlIGluY2x1ZGVzIFwiU09MRFwiIGFuZCBvdGhlciBrZXl3b3Jkc1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpc3RpbmdQYWdlID0gYXdhaXQgYnJvd3Nlci5uZXdQYWdlKCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgbGlzdGluZ1BhZ2UuZ290byhsaW5rLCB7IHdhaXRVbnRpbDogJ2RvbWNvbnRlbnRsb2FkZWQnIH0pO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbGlzdGluZ1RpdGxlID0gYXdhaXQgbGlzdGluZ1BhZ2UuZXZhbHVhdGUoKCkgPT4gXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0aXRsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucC10aXRsZS12YWx1ZScpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGl0bGVFbGVtZW50ID8gdGl0bGVFbGVtZW50LnRleHRDb250ZW50Py50cmltKCkgOiBudWxsO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgYXdhaXQgbGlzdGluZ1BhZ2UuY2xvc2UoKTtcblxuICAgICAgICAgICAgICAgIGlmIChsaXN0aW5nVGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBsaXN0aW5nVGl0bGUudG9VcHBlckNhc2UoKTsgLy9ub3JtYWxpemUgdGl0bGVzIGZvciBjb21wYXJpc29uXG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICF0aXRsZS5pbmNsdWRlcygnU09MRCcpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAhdGl0bGUuaW5jbHVkZXMoJ1BVUkNIQVNFRCcpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAhdGl0bGUuaW5jbHVkZXMoJ0NMT1NFRCcpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAhdGl0bGUuaW5jbHVkZXMoJ1RSQURFRCcpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZS5pbmNsdWRlcyhxdWVyeS50b1VwcGVyQ2FzZSgpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIXByaWNlLnN0YXJ0c1dpdGgoJzAuMDAnKSAvL1dUQiBvciBXVFQgbGlzdGluZ3MgaGF2ZSBhIHByaWNlIG9mIDAuMDAgYW5kIGNhbiBlYXNpbHkgYmUgZmlsdGVyZWQgb3V0IHdpdGggdGhpcyBjaGVja1xuICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHRpdGxlLCBsaW5rLCBwcmljZSwgc2l0ZX07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vUmV0dXJuIG51bGwgZm9yIGludmFsaWQgbGlzdGluZ3NcblxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBwcm9jZXNzaW5nIGxpc3RpbmcgJHtsaXN0aW5nLmxpbmt9OmAsIGVycm9yKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvL1Byb2Nlc3MgYWxsIGxpc3RpbmdzIGNvbmN1cnJlbnRseSB3aXRoIGEgbGltaXRlZCBudW1iZXIgb2YgdGFic1xuICAgICAgICBjb25zdCBtYXhDb25jdXJyZW5jeSA9IDEwOyAvLyBOdW1iZXIgb2YgY29uY3VycmVudCB0YWJzIE5leHQgU3RlcDogcm90YXRpbmcgcHJveGllcyBvciBwbHVnaW4gdG8gYXZvaWQgZGV0ZWN0aW9uXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBbXTsgXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdGluZ3NGcm9tU2VhcmNoLmxlbmd0aDsgaSArPSBtYXhDb25jdXJyZW5jeSkge1xuICAgICAgICAgICAgY29uc3QgY2h1bmsgPSBsaXN0aW5nc0Zyb21TZWFyY2guc2xpY2UoaSwgaSArIG1heENvbmN1cnJlbmN5KTtcbiAgICAgICAgICAgIGNvbnN0IGNodW5rUmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKGNodW5rLm1hcChsaXN0aW5nID0+IHByb2Nlc3NMaXN0aW5nKGxpc3RpbmcpKSk7XG4gICAgICAgICAgICByZXN1bHRzLnB1c2goLi4uY2h1bmtSZXN1bHRzLmZpbHRlcihCb29sZWFuKSk7IC8vIEZpbHRlciBvdXQgbnVsbCByZXN1bHRzXG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgYnJvd3Nlci5jbG9zZSgpOyBcblxuICAgICAgICAvL0NhY2hlIHRoZSByZXN1bHRzIGZvciB0aGUgcXVlcnlcbiAgICAgICAgY2FjaGUuc2V0KHF1ZXJ5LCByZXN1bHRzKTtcbiAgICAgICAgXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdHMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NjcmFwaW5nIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgYXdhaXQgYnJvd3Nlci5jbG9zZSgpO1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHJldHJpZXZlIGxpc3RpbmdzJyB9KTtcbiAgICB9XG4gICAgXG59XG4iXSwibmFtZXMiOlsicHVwcGV0ZWVyIiwiY2FjaGUiLCJNYXAiLCJzZXRJbnRlcnZhbCIsImNvbnNvbGUiLCJsb2ciLCJjbGVhciIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJxdWVyeSIsInRyaW0iLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJoYXMiLCJnZXQiLCJzZWFyY2hVcmwiLCJlbmNvZGVVUklDb21wb25lbnQiLCJicm93c2VyIiwibGF1bmNoIiwiaGVhZGxlc3MiLCJwYWdlIiwibmV3UGFnZSIsImdvdG8iLCJ3YWl0VW50aWwiLCJ3YWl0Rm9yU2VsZWN0b3IiLCJsaXN0aW5nc0Zyb21TZWFyY2giLCJldmFsdWF0ZSIsImxpc3RpbmdzIiwiaXRlbXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaXRlbSIsInRpdGxlRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwcmljZUVsZW1lbnQiLCJmbGFpckVsZW1lbnQiLCJ0aXRsZSIsInRleHRDb250ZW50IiwibGluayIsImdldEF0dHJpYnV0ZSIsInByaWNlIiwiZmxhaXIiLCJzaXRlIiwidG9VcHBlckNhc2UiLCJpbmNsdWRlcyIsInB1c2giLCJwcm9jZXNzTGlzdGluZyIsImxpc3RpbmciLCJsaXN0aW5nUGFnZSIsImxpc3RpbmdUaXRsZSIsImNsb3NlIiwic3RhcnRzV2l0aCIsIm1heENvbmN1cnJlbmN5IiwicmVzdWx0cyIsImkiLCJsZW5ndGgiLCJjaHVuayIsInNsaWNlIiwiY2h1bmtSZXN1bHRzIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsImZpbHRlciIsIkJvb2xlYW4iLCJzZXQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/headfi.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fheadfi&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fheadfi.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();